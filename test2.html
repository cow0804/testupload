<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圖片文字識別與表格生成</title>
    <script src="https://unpkg.com/tesseract.js@5.0.4/dist/tesseract.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        #preview {
            max-width: 100%;
            margin: 20px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        #loading {
            display: none;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>圖片文字識別與表格生成</h1>
    
    <input type="file" id="imageInput" accept="image/*">
    <img id="preview" alt="圖片預覽">
    <div id="loading">處理中，請稍候...</div>
    
    <div id="result"></div>

    <script>
        const imageInput = document.getElementById('imageInput');
        const preview = document.getElementById('preview');
        const loading = document.getElementById('loading');
        const result = document.getElementById('result');

        // 圖片預覽
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                preview.src = URL.createObjectURL(file);
                processImage(file);
            }
        });

        // 處理圖片並生成表格
        async function processImage(file) {
            loading.style.display = 'block';
            result.innerHTML = '';

            try {
                // 使用 Tesseract 識別文字
                const { data: { text } } = await Tesseract.recognize(
                    file,
                    'eng', // 語言設定為英文
                    {
                        tessedit_char_whitelist: '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ ', // 只識別數字和英文
                    }
                );

                // 將文字按行分割
                const lines = text.split('\n').filter(line => line.trim() !== '');
                
                // 創建表格
                let tableHTML = '<table><tr><th>內容</th></tr>';
                lines.forEach(line => {
                    tableHTML += `<tr><td>${line}</td></tr>`;
                });
                tableHTML += '</table>';

                result.innerHTML = tableHTML;
            } catch (error) {
                result.innerHTML = `<p style="color: red">錯誤：${error.message}</p>`;
            } finally {
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>
